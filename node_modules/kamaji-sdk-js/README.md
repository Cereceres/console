
<a href="http://4yopping.com">
    <img src="http://4yopping.com/4yopping.png" alt="4yopping Logo"
         title="4yopping Logo" align="right" width="120px" height="125px" />
</a>

# KAMAJI SDK

[![Circle CI](https://circleci.com/gh/4yopping/kamaji-sdk-js/tree/master.svg?style=svg&circle-token=7dab72ee1ba6d1a415fcc5f34fa8ea75a8f71d6e)](https://circleci.com/gh/4yopping/kamaji-sdk-js/tree/master)


Kamaji SDK for JavaScript

# Installing

```bash
$ npm install kamaji-sdk-js
```

# Getting starter

```js

import Kamaji from 'kamaji-sdk-js'

let kamaji = new Kamaji({
  app_key: 'Your_app_key',
  app_secret: 'Your_very_secure_secret',
  host: 'https://private-4yopping-super-secure-3000-kamaji-ip',
  key: fs.readFileSync('./keys/client-key.pem'),
  cert: fs.readFileSync('./keys/client-cert.pem'),
  ca: ['./keys/server-cert.pem'],
  requestCert: true,
  rejectUnauthorized: true
})
```


# Usage

Create

```js

let Customer = kamaji.Customer;

// Sends a post
let jhon = new Customer({
  name: 'Juanito Falso'
}).save().then().catch()
// Returns {id:'123479', name:'Juanito Falso'}
```

Get customer

```js
// Obtains a customer
let jhon = new Customer({
  _id: '123479'
}).fetch().then().catch()
// Returns {id:'123479', name:'Juanito Falso'}
```


Update

```js
let jhon = new Customer({
  _id: '123479'
})

let response = yield jhon.fetch()
// Returns {id:'123479', name:'Juanito Recargado'}

jhon.set({
  name: 'Juanito Recargado'
}).save()
// Returns {id:'123479', name:'Juanito Recargado'}

```

Remove

```js
let jhon = yield new Customer({
  _id: '123479'
})

jhon.remove().then().catch()
// undefined

```



# General methods

<table>
  <thead>
    <th>Method name</th>
    <th>Description</th>
    <th>Modifier</th>
  </thead>
  <tbody>
    <tr><td>save()</td><td>Sends a POST or PUT request</td><td>public</td></tr>
    <tr><td>fetch()</td><td>Sends a GET request</td><td>public</td></tr>
    <tr><td>set()</td><td>Sets properties to object</td><td>public</td></tr>
    <tr><td>remove()</td><td>Sends a DELETE request</td><td>public</td></tr>
  </tbody>
</table>

# Queries
To send queries, for example in the case of obtaining products based on a template use the query object in fetch method.

```js
let product = yield new Product({
  params : Customer.Age
})
// or the params can be passed to fetch Method too
product.fetch({
  p
  query : {
    template: 'my-template'
    dbQuery : {active : true}
  }
}).then().catch()
// you can pass into properties of product the  dbQuery to be used in the search
// method of mongoose, the default value is the stored in the template
// object in DB  and param to
// be passed  as argument to every filter function into the template
```


# Examples
  [View the tests](./test)


# Supported objects
  API documentation [View docs](http://docs.kamajirest.apiary.io)

  <table>
    <thead>
      <th>Service Name</th>
      <th>Path</th>
      <th>API Version</th>
    </thead>
    <tbody>
      <tr><td>Kamaji auth</td><td>oauth</td><td>1.0</td></tr>
      <tr><td>Kamaji customer</td><td>customer</td><td>1.0</td></tr>
      <tr><td>Kamaji order</td><td>orders</td><td>1.0</td></tr>
      <tr><td>Kamaji payment</td><td>payments</td><td>1.0</td></tr>
      <tr><td>Kamaji card</td><td>cards</td><td>1.0</td></tr>
      <tr><td>Kamaji product</td><td>cards</td><td>1.0</td></tr>
      <tr><td>Kamaji log</td><td>cards</td><td>1.0</td></tr>
      <tr><td>Kamaji custom path</td><td>{{path}}</td><td>N/A</td></tr>
    </tbody>
  </table>



# Custom request

Use the api method (this method requires call connect before being executed)

`kamaji.api(path, method, [data]);`

E.g.:

```js
kamaji.connect().then(() => {
  kamaji.api('/custom_path', 'post', {data: 'my_data'})
    .then()
    .catch();
});
```



# Testing

Running the tests

```bash
npm test
```


## License
This projects and it's consequent projects, modules and connections will not be under any open source license until the 4yopping CTO communicates the contrary in a formal way.
